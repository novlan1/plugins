:::info 作者

novlan1

2025.8.25

:::

# 批量发布

## 1. 介绍

研发平台实现了 Web 项目的批量发布，之前需审核多次的场景现在只需审核一次。

## 2. 如何操作

之前的发布界面，多选子工程即可。

<img src="https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2025/8/own_mike_nbQddQGh2bCiaXr2.png" width="600" />

## 3. 实现方式

有两个方案：

1. 改造流水线，`VUE_APP_DIR` 支持传入多个子工程
2. 研发平台后端包装批量发布，队列形式依次调用之前的发布方法

方案一改造成本大，不只是 `VUE_APP_DIR` 这一个变量涉及的插件要改，还有构建产物相关的插件，比如 `sourceMap` 上传、CDN 上传、打包产物归档，还有非上云、上云不同的部署流程。

目前采用的是方案二，简单、灵活、易扩展。

采用方案二的话，如何存储多个待发布的子工程呢？这里直接放到了操作记录这个表里。

批量发布的操作记录是一条，还是多条呢？这里采用的是一条，每发布完一个子工程，就更新部分字段。

## 4. 好处

实现批量发布后：

- 发布效率高。只需审核一次。
- 开发者更专注。如果需发布10个子工程，每次发布需5分钟，开发者就需要在50分钟内切换10次上下文。支持批量发布后，只需要切换1次上下文。
